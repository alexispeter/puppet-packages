try {
  var login_db = db.getSiblingDB('<%= @database %>');
  try {
    // will fail if authentication is required
    // otherwise will continue without authentication
    var list = db.getUsers();
  } catch(e) {
    // auth() can be called only if authentication is enabled
    // and will throw if not enabled or if credentials are incorrect
    login_db.auth('<%= @username %>', '<%= @password %>')
  }
}
