require 'spec_helper'

describe 'php5::extension::imagick' do

  describe command('php --ri imagick') do
    its(:exit_status) { should eq 0 }
  end

  describe command('php /tmp/CVE-2016-3714-good.php') do
    its(:exit_status) { should eq 0 }
  end

  describe command('php /tmp/CVE-2016-3714-bad.php') do
    its(:exit_status) { should_not eq 0 }
    its(:stdout) { should match('not authorized') }
    its(:stdout) { should_not match('0wned') }
  end

end
